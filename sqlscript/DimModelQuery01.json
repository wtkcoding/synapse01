{
	"name": "DimModelQuery01",
	"properties": {
		"content": {
			"query": "-- SELECT\n--     Coalesce(p.[ModelName], p.[EnglishProductName]) AS [Model]\n--     ,g.City AS ResellerCity\n--     ,g.StateProvinceName AS StateProvince\n--     ,Year(f.OrderDate) AS CalendarYear\n--     ,CASE\n--         WHEN Month(f.OrderDate) < 7 THEN Year(f.OrderDate)\n--         ELSE Year(f.OrderDate) + 1\n--     END AS FiscalYear -- Fiscal year runs from Jul to June)\n--     ,Month(f.OrderDate) AS [Month]\n--     ,Sum(f.OrderQuantity) AS Quantity\n--     ,ROUND(Sum(f.ExtendedAmount), 2) AS Amount\n--     ,Approx_count_distinct(f.SalesOrderNumber) AS UniqueOrders  \n-- FROM\n--     [dbo].[FactResellerSales] f\n-- INNER JOIN [dbo].[DimReseller] r\n--     ON f.ResellerKey = r.ResellerKey\n-- INNER JOIN [dbo].[DimGeography] g\n--     ON r.GeographyKey = g.GeographyKey\n-- INNER JOIN [dbo].[DimProduct] p\n--     ON f.[ProductKey] = p.[ProductKey]\n-- GROUP BY\n--     Coalesce(p.[ModelName], p.[EnglishProductName])\n--     ,g.City\n--     ,g.StateProvinceName\n--     ,Year(f.OrderDate)\n--     ,CASE\n--         WHEN Month(f.OrderDate) < 7 THEN Year(f.OrderDate)\n--         ELSE Year(f.OrderDate) + 1\n--     END\n--     ,Month(f.OrderDate)\n-- ORDER BY Amount DESC\n\n\n-- SELECT\n--     pc.EnglishProductCategoryName AS ProductCategory\n--     ,psc.EnglishProductSubcategoryName AS ProductSubcategory\n--     ,Year(f.OrderDate) AS CalendarYear\n--     ,CASE\n--         WHEN Month(f.OrderDate) < 7 THEN Year(f.OrderDate)\n--         ELSE Year(f.OrderDate) + 1\n--     END AS FiscalYear -- Fiscal year runs from Jul to June)\n--     ,Month(f.OrderDate) AS [Month]\n--     ,Sum(f.OrderQuantity) AS Quantity\n--     ,Sum(f.ExtendedAmount) AS Amount\n--     ,Approx_count_distinct(f.SalesOrderNumber) AS UniqueOrders  \n-- FROM\n--     [dbo].[FactResellerSales] f\n-- INNER JOIN [dbo].[DimProduct] p\n--     ON f.[ProductKey] = p.[ProductKey]\n-- INNER JOIN [dbo].[DimProductSubcategory] psc\n--     ON p.[ProductSubcategoryKey] = psc.[ProductSubcategoryKey]\n-- INNER JOIN [dbo].[DimProductCategory] pc\n--     ON psc.[ProductCategoryKey] = pc.[ProductCategoryKey]\n-- GROUP BY\n--     pc.EnglishProductCategoryName\n--     ,psc.EnglishProductSubcategoryName\n--     ,Year(f.OrderDate)\n--     ,CASE\n--         WHEN Month(f.OrderDate) < 7 THEN Year(f.OrderDate)\n--         ELSE Year(f.OrderDate) + 1\n--     END\n--     ,Month(f.OrderDate)\n-- ORDER BY Amount DESC\n\nSELECT\n    Coalesce(p.[ModelName], p.[EnglishProductName]) AS [Model]\n    ,g.City AS ResellerCity\n    ,g.StateProvinceName AS StateProvince\n    ,d.[CalendarYear]\n    ,d.[FiscalYear]\n    ,d.[MonthOfYear] AS [Month]\n    ,sum(f.OrderQuantity) AS Quantity\n    ,sum(f.ExtendedAmount) AS Amount\n    ,approx_count_distinct(f.SalesOrderNumber) AS UniqueOrders  \nFROM\n    [dbo].[FactResellerSales] f\nINNER JOIN [dbo].[DimReseller] r\n    ON f.ResellerKey = r.ResellerKey\nINNER JOIN [dbo].[DimGeography] g\n    ON r.GeographyKey = g.GeographyKey\nINNER JOIN [dbo].[DimDate] d\n    ON f.[OrderDateKey] = d.[DateKey]\nINNER JOIN [dbo].[DimProduct] p\n    ON f.[ProductKey] = p.[ProductKey]\nWHERE d.[MonthOfYear] = 10 AND d.[FiscalYear] IN (2012, 2013)\nGROUP BY\n    Coalesce(p.[ModelName], p.[EnglishProductName])\n    ,g.City\n    ,g.StateProvinceName\n    ,d.[CalendarYear]\n    ,d.[FiscalYear]\n    ,d.[MonthOfYear]\nORDER BY d.[FiscalYear]",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "SQLPool01",
				"poolName": "SQLPool01"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}